#!/bin/sh
set -e

DB_HOST="db"
DB_PORT="5432"

echo "‚è≥ –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—ñ Postgres ($DB_HOST:$DB_PORT)..."

while ! nc -z $DB_HOST $DB_PORT; do
  sleep 1
done

echo "‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –¥–æ—Å—Ç—É–ø–Ω–∞."

echo "üöÄ –ó–∞–ø—É—Å–∫ –º—ñ–≥—Ä–∞—Ü—ñ–π..."
# –ó–∞–ø—É—Å–∫ –±–∞–Ω–¥–ª–∞ (—è–∫—â–æ –≤—ñ–Ω —î —ñ –ø—Ä–∞–≤–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ)
./efbundle 

echo "‚úÖ –ú—ñ–≥—Ä–∞—Ü—ñ—ó –≤–∏–∫–æ–Ω–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ."

echo "üèÅ –ó–∞–ø—É—Å–∫ API..."
exec dotnet track-list-api.dll